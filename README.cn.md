ğŸŒ è¯­è¨€åˆ‡æ¢ | Language Switch: [English](./README.md) | [ä¸­æ–‡](./README.cn.md)

# çº¢åŒ…é›¨å°ç¨‹åº

åŸºäº Vue 3 å’Œè‹¥ä¾æ¡†æ¶å¼€å‘äº†ä¸€ä¸ªå°ç¨‹åºã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

- **æŠ½å¥–ç³»ç»Ÿ**ï¼šæ¯ä½ç”¨æˆ·æ¯å¤©æœ€å¤šæŠ½å¥– 3 æ¬¡ï¼Œè·å¥–åè‡ªåŠ¨ç»“æŸã€‚
- **æµé‡æ§åˆ¶**ï¼šæ£€æµ‹é«˜ç”¨æˆ·æµé‡å¹¶æ˜¾ç¤ºæ‹¥å µé€šçŸ¥ã€‚
- **äº¤äº’åŠ¨ç”»**ï¼šä¸‹è½çš„çº¢åŒ…åŠ¨ç”»å’Œå¯ç‚¹å‡»çš„å¥–åŠ±è§¦å‘ã€‚
- **ä¼˜æƒ åˆ¸é¡µé¢**ï¼šè®¾è®¡äº†å“åº”å¼å¸ƒå±€ï¼ŒåŒ…å«è¿”å›å¯¼èˆªã€‚

![çº¢åŒ…é›¨æˆªå›¾](https://github.com/user-attachments/assets/ee03551b-73a5-4565-862b-7016bc432df9)

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**ï¼šVue 3, Pinia, Vite
- **åç«¯**ï¼šè‹¥ä¾æ¡†æ¶ï¼ˆSpring Bootï¼‰
- **æ•°æ®åº“**ï¼šMySQL
- **API**ï¼šRESTful API
- **éƒ¨ç½²**ï¼šNginx + Docker

## å¼€å‘è¿›å±•

ç¬¬ä¸€é˜¶æ®µå’Œç¬¬äºŒé˜¶æ®µå¯å¹¶è¡Œè¿›è¡Œï¼Œä¼˜å…ˆå®Œæˆ MVPã€‚

### ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®åº“è®¾è®¡ä¸ API å¼€å‘ï¼ˆè¿›è¡Œä¸­ï¼š3 å¤©ï¼‰

#### âœ… **å·²å®Œæˆä»»åŠ¡ï¼š**

**æ•°æ®åº“è®¾è®¡** `8/5 - 8/6`

**ä»£ç ç”Ÿæˆ** `8/6`
- âœ… å®ä½“ç±»å·²ç”Ÿæˆ
- âœ… Mapper æ¥å£å·²ç”Ÿæˆ
- âœ… åŸºç¡€ CRUD Service å’Œ Controller å±‚å·²ç”Ÿæˆ
- âœ… èœå•é…ç½® SQL æ–‡ä»¶å·²ç”Ÿæˆ

#### ğŸ”„ **è¿›è¡Œä¸­ä»»åŠ¡ï¼š**

**æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®ç°** `8/6 - present`

1. **æŠ½å¥–æ§åˆ¶å™¨å¼€å‘**
   ```java
   @RestController
   @RequestMapping("/api/lottery")
   public class LotteryController {
       @PostMapping("/draw")           // æ‰§è¡ŒæŠ½å¥–
       @GetMapping("/records")         // è·å–ç”¨æˆ·æŠ½å¥–è®°å½•
       @GetMapping("/drawCount")       // æ£€æŸ¥å‰©ä½™æŠ½å¥–æ¬¡æ•°
       @GetMapping("/prizes")          // è·å–å¯ç”¨å¥–å“
       @GetMapping("/status")          // æ£€æŸ¥ç”¨æˆ·æŠ½å¥–èµ„æ ¼
   }
   ```

2. **æŠ½å¥–æœåŠ¡å±‚**
   ```java
   @Service
   public class LotteryService {
       // æ£€æŸ¥ç”¨æˆ·æŠ½å¥–èµ„æ ¼ï¼ˆæ¯æ—¥é™åˆ¶ã€å·²ä¸­å¥–ã€IPé™åˆ¶ï¼‰
       boolean checkDrawEligibility(Long userId, String ipAddress);
       
       // æ‰§è¡ŒæŠ½å¥–ç®—æ³•ï¼Œæ¦‚ç‡æ§åˆ¶
       DrawResult executeDraw(Long userId);
       
       // ä¿å­˜æŠ½å¥–è®°å½•åˆ°æ•°æ®åº“
       void saveDrawRecord(Long userId, DrawResult result, String ipAddress);
       
       // è·å–ç”¨æˆ·ä»Šæ—¥å‰©ä½™æŠ½å¥–æ¬¡æ•°
       int getRemainingDrawCount(Long userId);
       
       // æ£€æŸ¥ç”¨æˆ·ä»Šæ—¥æ˜¯å¦å·²ä¸­å¥–
       boolean hasWonToday(Long userId);
   }
   ```

3. **é˜²åˆ·ç¥¨æœºåˆ¶**
   - **æ¯æ—¥é™åˆ¶æ§åˆ¶**ï¼šæ¯ç”¨æˆ·æ¯å¤©æœ€å¤š3æ¬¡æŠ½å¥–
   - **ä¸­å¥–è€…é™åˆ¶**ï¼šä¸­å¥–ååœæ­¢æŠ½å¥–
   - **IPé¢‘ç‡é™åˆ¶**ï¼šé˜²æ­¢åŒä¸€IPè¿‡åº¦æŠ½å¥–
   - **å¹¶å‘æ§åˆ¶**ï¼šåŸºäºRedisçš„åº“å­˜ç®¡ç†
   - **è¯·æ±‚èŠ‚æµ**ï¼šæŠ½å¥–é—´éš”æœ€å°æ—¶é—´é™åˆ¶

4. **æ¦‚ç‡ç®—æ³•**
   ```java
   // åŸºäºå¥–å“æ¦‚ç‡çš„åŠ æƒéšæœºé€‰æ‹©
   // RedisåŸå­æ“ä½œè¿›è¡Œåº“å­˜æ‰£å‡
   // å¥–å“ç”¨å®Œæ—¶çš„é™çº§æœºåˆ¶
   ```

5. **é…ç½®ç®¡ç†**
   - æ´»åŠ¨æ—¶é—´æ§åˆ¶ï¼ˆå¼€å§‹/ç»“æŸæ—¶é—´ï¼‰
   - å¹¶å‘ç”¨æˆ·æ•°é™åˆ¶
   - å¥–å“æ¦‚ç‡è°ƒæ•´
   - æ¯æ—¥æŠ½å¥–æ¬¡æ•°é…ç½®

#### ğŸ“‹ **API æ¥å£è§„èŒƒï¼š**

| æ¥å£åœ°å€ | è¯·æ±‚æ–¹å¼ | åŠŸèƒ½æè¿° | çŠ¶æ€ |
|----------|----------|----------|------|
| `/api/lottery/draw` | POST | æ‰§è¡ŒæŠ½å¥– | ğŸ”„ è¿›è¡Œä¸­ |
| `/api/lottery/records` | GET | è·å–ç”¨æˆ·æŠ½å¥–å†å² | ğŸ”„ è¿›è¡Œä¸­ |
| `/api/lottery/drawCount` | GET | è·å–å‰©ä½™æŠ½å¥–æ¬¡æ•° | ğŸ”„ è¿›è¡Œä¸­ |
| `/api/lottery/prizes` | GET | è·å–å¥–å“é…ç½® | ğŸ”„ è¿›è¡Œä¸­ |
| `/api/lottery/status` | GET | æ£€æŸ¥ç”¨æˆ·æŠ½å¥–èµ„æ ¼ | ğŸ”„ è¿›è¡Œä¸­ |
| `/api/activity/config` | GET | è·å–æ´»åŠ¨è®¾ç½® | ğŸ”„ è¿›è¡Œä¸­ |

### ç¬¬äºŒé˜¶æ®µï¼šå‰ç«¯é¡µé¢ç»“æ„ä¸ API é›†æˆï¼ˆè¿›è¡Œä¸­ï¼š3 å¤©ï¼‰

```
é¦–é¡µ (/)
â”œâ”€ ç‚¹å‡»â€œåŠ å…¥æ´»åŠ¨â€ â†’ ç™»å½•é¡µé¢ (/login)
â”‚   â”œâ”€ ç™»å½•æˆåŠŸå â†’ åˆ¤æ–­ä¸­å¥–çŠ¶æ€
â”‚   â”‚   â”œâ”€ å¦‚æœå·²ä¸­å¥– â†’ æ˜¾ç¤º PrizeModal å¼¹çª—
|   â”‚   â”œâ”€ å¦‚æœæœªä¸­å¥– â†’ è‡ªåŠ¨è·³è½¬ â†’ åŠ è½½é¡µé¢ (/loading)
|   |   â”‚   â”œâ”€ å¦‚æœäººæ•°æ‹¥æŒ¤ â†’ æ‹¥æŒ¤æç¤ºç»„ä»¶
|   |   â”‚   â”œâ”€ å¦‚æœä¸æ‹¥æŒ¤ â†’ å€’è®¡æ—¶é¡µé¢ (/countdown)
|   â”‚   â”‚   â”‚   â”œâ”€ å€’è®¡æ—¶ç»“æŸ â†’ çº¢åŒ…é¡µé¢ (/redpacket)
|   â”‚   â”‚   â”‚   â”‚   â”œâ”€ ç”¨æˆ·ä¸­å¥– â†’ æ˜¾ç¤º PrizeModal å¼¹çª—
|   â”‚   â”‚   â”‚   â”‚   â””â”€ ç”¨æˆ·æœªä¸­å¥– â†’ æ˜¾ç¤º EncourageTip å¼¹çª—
â”‚   â”‚   â”‚   â””â”€ æŠ½å¥–å â†’ è¿”å›é¦–é¡µ (/)
â”œâ”€ ç‚¹å‡»â€œæ´»åŠ¨è§„åˆ™â€ â†’ è§„åˆ™é¡µé¢ (/rule)
â””â”€ æŠ½å¥–ç»“æŸæˆ–ç”¨æˆ·ç™»å½•å â†’ ä¼˜æƒ åˆ¸é¡µé¢ (/coupon)
```
```
ğŸ“¦ è·¯ç”±é¡µé¢ç»“æ„ï¼ˆPageå±‚çº§ï¼‰
/
â”œâ”€â”€ HomePage (/)
â”‚   â”œâ”€â”€ åŠ å…¥æ´»åŠ¨ â†’ ç™»å½•é¡µï¼ˆ/loginï¼‰
â”‚   â””â”€â”€ æ´»åŠ¨è§„åˆ™é¡µï¼ˆ/ruleï¼‰
â”‚   â””â”€â”€ æŸ¥çœ‹æˆ‘çš„ä¼˜æƒ åˆ¸ï¼ˆ/couponï¼‰

â”œâ”€â”€ LoginPage (/login)
â”‚   â”œâ”€â”€ ç™»å½•æˆåŠŸ â†’ åˆ¤æ–­æ˜¯å¦ä¸­å¥–
â”‚   â”‚   â”œâ”€â”€ å·²ä¸­å¥– â†’ PrizeModalï¼ˆç»„ä»¶ï¼‰
â”‚   â”‚   â””â”€â”€ æœªä¸­å¥– â†’ /loading

â”œâ”€â”€ LoadingPage (/loading)
â”‚   â”œâ”€â”€ æ‹¥æŒ¤ â†’ CrowdingTipï¼ˆç»„ä»¶ï¼‰
â”‚   â””â”€â”€ æ­£å¸¸ â†’ å€’è®¡æ—¶é¡µé¢ /countdown

â”œâ”€â”€ CountdownPage (/countdown)
â”‚   â””â”€â”€ å€’è®¡æ—¶ç»“æŸ â†’ /redpacket

â”œâ”€â”€ RedPacketPage (/redpacket)
â”‚   â”œâ”€â”€ æŠ½å¥–å®Œæˆï¼ˆç‚¹å‡»çº¢åŒ…ï¼‰
â”‚   â”‚   â”œâ”€â”€ ä¸­å¥– â†’ PrizeModalï¼ˆç»„ä»¶ï¼‰
â”‚   â”‚   â””â”€â”€ æœªä¸­å¥– â†’ EncourageTipï¼ˆç»„ä»¶ï¼‰
â”‚   â””â”€â”€ æŠ½å¥–åè‡ªåŠ¨è¿”å› HomePage

â”œâ”€â”€ RulePage (/rule)
â”‚   â””â”€â”€ æ˜¾ç¤ºæ´»åŠ¨è§„åˆ™é™æ€å†…å®¹

â”œâ”€â”€ CouponPage (/coupon)
â”‚   â””â”€â”€ æ˜¾ç¤ºå·²é¢†å–çš„åˆ¸ + è¿”å›æŒ‰é’®

```
- **LoginPage.vue**
  1. ç”¨æˆ·çŠ¶æ€æ£€æµ‹ï¼ˆé€šè¿‡ token ç™»å½•ï¼‰
  2. é…ç½® Axios è¯·æ±‚æ‹¦æˆªå™¨

- **çº¢åŒ…é€»è¾‘**ï¼š*ä¸‹è½çº¢åŒ…åŠ¨ç”»*ï¼Œ*ç‚¹å‡»è§¦å‘æŠ½å¥–è¯·æ±‚*ï¼Œ*å¼¹çª—æ˜¾ç¤ºä¸­å¥–æˆ–æœªä¸­å¥–*

```javascript
let totalRedPackets = 100;
let interval = setInterval(() => {
  if (totalRedPackets <= 0) clearInterval(interval);
  generateRedPacket(); // æ¯æ¬¡ç”Ÿæˆ 1 ä¸ªçº¢åŒ…åŠ¨ç”»
  totalRedPackets--;
}, 200);
```

- **æµé‡æ£€æµ‹**ï¼šâ€œé™æµâ€é—®é¢˜ -> åç«¯é™æµ + çŠ¶æ€å“åº” + å‰ç«¯åŠ è½½åˆ¤æ–­ï¼Œè¿”å› `{ "status": "crowded" } // æˆ– "ok"`

- **éšæœºåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æŠ¢åˆ°çº¢åŒ…**ï¼š

```java
// æŸ¥è¯¢ä»Šæ—¥æŠ½å¥–è®°å½•
List<UserPrizeLog> logs = userPrizeLogMapper.queryToday(userId);
if (logs.size() >= 3) return fail("æ¬¡æ•°ç”¨å°½");

boolean alreadyWon = logs.stream().anyMatch(log -> log.isWin());
if (alreadyWon) return fail("å·²ä¸­å¥–");

boolean isWin = Math.random() < 0.2; // 20% ä¸­å¥–æ¦‚ç‡ï¼Œåå°å¯é…ç½®
if (isWin) {
    // éšæœºåˆ†é…å¥–å“
    Prize prize = prizeService.getRandomAvailablePrize();
    saveUserPrize(userId, prize);
}
```

**å¯é…ç½®çš„å¥–å“åˆ†é…ç®—æ³•**ï¼š
- ä½¿ç”¨ Redis è¿›è¡Œåº“å­˜æ‰£å‡ï¼ˆé˜²æ­¢å¹¶å‘è¶…å‘ï¼‰
- å¥–å“æ¦‚ç‡å­˜å‚¨åœ¨æ•°æ®åº“çš„å¯é…ç½®å­—æ®µä¸­

### ç¬¬ä¸‰é˜¶æ®µï¼šé›†æˆä¸éƒ¨ç½²å‡†å¤‡ï¼ˆè¿›è¡Œä¸­ï¼š1 å¤©ï¼‰

- è¿æ¥å‰ç«¯å’Œåç«¯æŠ½å¥–é€»è¾‘
- éªŒè¯æŠ½å¥–é™åˆ¶å’Œä¸­å¥–é€»è¾‘

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯æˆæƒã€‚è¯¦æƒ…è§ [LICENSE](./LICENSE) æ–‡ä»¶ã€‚
